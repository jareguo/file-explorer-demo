exports.MY_COMPUTER_NAME = "My Computer"
exports.MY_COMPUTER_PATH = "{20D04FE0-3AEA-1069-A2D8-08002B30309D}"

var exec = require('child_process').exec

function getDrives(callback) {
    // http://stackoverflow.com/questions/15878969/enumerate-system-drives-in-nodejs
    // XP can not use this cmd in exec
    var cmd = 'wmic LOGICALDISK get name';   //var cmd = 'wmic LOGICALDISK get volumename'
    exec('dir', function (err, stdout, stderr) {
        var drives = [];
        if (err) {
            console.error('error running ' + cmd + ": " + err);
            callback(drives);
            return;
        }
        var entries = stdout.split('\r\n');
        entries = entries.slice(1, entries.length);
        for (var i = 0; i < entries.length; ++i) {
            if (entries[i].trim()) {
                drives.push(entries[i].trim());
            }
        }
        callback(drives);
    })
}

exports.getDrives = getDrives;